From 48d8c4f9127e70a8e2fa734633761536de27110e Mon Sep 17 00:00:00 2001
From: "ning.fang" <ning.fang@artinchip.com>
Date: Tue, 23 May 2023 20:08:58 +0800
Subject: [PATCH] lvgl: compile v8.3.2

---
 CMakeLists.txt         | 6 ++++++
 src/draw/lv_draw_img.c | 2 ++
 2 files changed, 8 insertions(+)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index c1f72b8..91cc479 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -1,9 +1,15 @@
 cmake_minimum_required(VERSION 3.12.4)
 
+# Suppress cmake unused warning
+set(ignore ${BUILD_DOC} ${BUILD_DOCS} ${BUILD_EXAMPLE} ${BUILD_EXAMPLES}
+ ${BUILD_SHARED_LIBS}${BUILD_TEST}${BUILD_TESTING}${BUILD_TESTS})
+
 if(NOT ESP_PLATFORM)
   project(lvgl HOMEPAGE_URL https://github.com/lvgl/lvgl)
 endif()
 
+set(CMAKE_C_FLAGS "-O0 -g0")
+
 set(LVGL_ROOT_DIR ${CMAKE_CURRENT_LIST_DIR})
 
 if(ESP_PLATFORM)
diff --git a/src/draw/lv_draw_img.c b/src/draw/lv_draw_img.c
index 41dc0f0..b9204c2 100644
--- a/src/draw/lv_draw_img.c
+++ b/src/draw/lv_draw_img.c
@@ -72,6 +72,8 @@ void lv_draw_img(lv_draw_ctx_t * draw_ctx, const lv_draw_img_dsc_t * dsc, const
     lv_res_t res;
     if(draw_ctx->draw_img) {
         res = draw_ctx->draw_img(draw_ctx, dsc, coords, src);
+        if (res ==LV_RES_INV)
+            res = decode_and_draw(draw_ctx, dsc, coords, src);
     }
     else {
         res = decode_and_draw(draw_ctx, dsc, coords, src);
-- 
2.29.0

